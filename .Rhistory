bind_rows(observations) %>% #%>% filter(Generation <= 116)) %>%
#filter(Population %in% c("gln_07")) %>% #"bc01", "bc02","gln_01", "gln_06", "gln_08" #"gln_07"
ggplot(aes(Generation, prop_CNV, color = Population),fill = presim_rep) +
geom_line(aes(linetype = type), size=1.5, alpha = 0.7) +
facet_wrap(~Population) +
scale_linetype_manual(values = c("solid", "dotted", "longdash"),
breaks = c("Observation", "WF PPC","Chemo PPC"), name = "") +
scale_color_manual(values=mycolors) +
ylab("Proportion of cells with GAP1 CNV") +
geom_point(data=param_data,aes(x=mean_rmse_ppc, y=mean_rmse_ppc, shape=as.factor(presim_rep)),alpha = 0) +
guides(shape = guide_legend(override.aes = list(alpha = 1)), linetype=guide_legend(keywidth = 3, keyheight = 1))
d5
d5 = py$ppc_chemo_all %>%
as_tibble() %>%
bind_rows(py$ppc_wf_all) %>%
filter(gen ==  116) %>%
filter(presim_rep == 1) %>%
pivot_longer(cols = `25`:`267`, names_to = "generation", values_to = "prop_CNV") %>%
mutate(type = case_when(Model == "Chemo"~"Chemo PPC",
Model == "WF" ~"WF PPC")) %>%
mutate(Generation = as.numeric(generation)) %>%
select(Generation, Population, prop_CNV, type) %>%
bind_rows(observations) %>% #%>% filter(Generation <= 116)) %>%
#filter(Population %in% c("gln_07")) %>% #"bc01", "bc02","gln_01", "gln_06", "gln_08" #"gln_07"
ggplot(aes(Generation, prop_CNV, color = Population)) +
geom_line(aes(linetype = type), size=1.5, alpha = 0.7) +
facet_wrap(~Population) +
scale_linetype_manual(values = c("solid", "dotted", "longdash"),
breaks = c("Observation", "WF PPC","Chemo PPC"), name = "") +
scale_color_manual(values=mycolors) +
ylab("Proportion of cells with GAP1 CNV") +
geom_point(data=param_data,aes(x=mean_rmse_ppc, y=mean_rmse_ppc, shape=as.factor(presim_rep)),alpha = 0) +
guides(shape = guide_legend(override.aes = list(alpha = 1)), linetype=guide_legend(keywidth = 3, keyheight = 1))
d5
d5 = py$ppc_chemo_all %>%
as_tibble() %>%
bind_rows(py$ppc_wf_all) %>%
filter(gen ==  116) %>%
filter(presim_rep == 1) %>%
pivot_longer(cols = `25`:`267`, names_to = "generation", values_to = "prop_CNV") %>%
mutate(type = case_when(Model == "Chemo"~"Chemo PPC",
Model == "WF" ~"WF PPC")) %>%
mutate(Generation = as.numeric(generation)) %>%
select(Generation, Population, prop_CNV, type) %>%
bind_rows(observations) %>% #%>% filter(Generation <= 116)) %>%
#filter(Population %in% c("gln_07")) %>% #"bc01", "bc02","gln_01", "gln_06", "gln_08" #"gln_07"
ggplot(aes(Generation, prop_CNV, color = Population)) +
geom_line(aes(linetype = type), size=1.5, alpha = 0.7) +
facet_wrap(~Population) +
scale_linetype_manual(values = c("solid", "dotted", "longdash"),
breaks = c("Observation", "WF PPC","Chemo PPC"), name = "") +
scale_color_manual(values=mycolors) +
ylab("Proportion of cells with GAP1 CNV") +
guides(shape = guide_legend(override.aes = list(alpha = 1)), linetype=guide_legend(keywidth = 3, keyheight = 1))
d5
d5 = py$ppc_chemo_all %>%
as_tibble() %>%
bind_rows(py$ppc_wf_all) %>%
filter(gen ==  116) %>%
filter(presim_rep == 1) %>%
pivot_longer(cols = `25`:`267`, names_to = "generation", values_to = "prop_CNV") %>%
mutate(type = case_when(Model == "Chemo"~"Chemo PPC",
Model == "WF" ~"WF PPC")) %>%
mutate(Generation = as.numeric(generation)) %>%
select(Generation, Population, prop_CNV, type) %>%
bind_rows(observations) %>% #%>% filter(Generation <= 116)) %>%
#filter(Population %in% c("gln_07")) %>% #"bc01", "bc02","gln_01", "gln_06", "gln_08" #"gln_07"
ggplot(aes(Generation, prop_CNV, color = Population)) +
geom_line(aes(linetype = type), size=1.5, alpha = 0.7) +
facet_wrap(~Population) +
scale_linetype_manual(values = c("solid", "dotted", "longdash"),
breaks = c("Observation", "WF PPC","Chemo PPC"), name = "") +
scale_color_manual(values=mycolors) +
ylab("Proportion of cells with GAP1 CNV") +
#geom_point(data=param_data,aes(x=mean_rmse_ppc, y=mean_rmse_ppc, shape=as.factor(presim_rep)),alpha = 0) +
guides(shape = guide_legend(override.aes = list(alpha = 1)), linetype=guide_legend(keywidth = 3, keyheight = 1))
layout <- "
AADDDD
BBDDDD
CCDDDD
"
fig5 = a5 + b5 + c5 + d5 + plot_annotation(tag_levels = 'A') + plot_layout(design = layout)
fig5
#ggsave(paste0(fig_path,"Figure5.pdf"), plot = fig5, width = 18, height = 15, units = "in")
ggsave(paste0(fig_path,"Figure5.png"), plot = fig5, width = 25, height = 15, units = "in")
layout <- "
AADDDD
BBDDDD
CCDDDD
"
fig5 = a5 + b5 + c5 + d5 + plot_annotation(tag_levels = 'A') + plot_layout(design = layout)
fig5
ggsave(paste0(fig_path,"Figure5.pdf"), plot = fig5, width = 25, height = 15, units = "in")
ggsave(paste0(fig_path,"Figure5.png"), plot = fig5, width = 25, height = 15, units = "in")
ggsave(paste0(fig_path,"Figure5.png"), plot = fig5, width = 24, height = 14, units = "in")
c5 = param_data %>%
filter(gen == 116) %>%
ggplot(aes(Model, mean_rmse_ppc, color=Population,fill=Population, shape=as.factor(presim_rep))) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.75)) +
ylab("Posterior predictive\naccuracy (RMSE)") +
xlab("") +
scale_color_manual(values=mycolors, name = "Population") +
scale_shape_manual(values = c(21, 22, 23), name = "Inference set") +
scale_fill_manual(values=mycolors, name="Population") +
theme(legend.position = "none")
c5
layout <- "
AADDDD
BBDDDD
CCDDDD
"
fig5 = a5 + b5 + c5 + d5 + plot_annotation(tag_levels = 'A') + plot_layout(design = layout)
fig5
ggsave(paste0(fig_path,"Figure5.pdf"), plot = fig5, width = 25, height = 15, units = "in")
ggsave(paste0(fig_path,"Figure5.png"), plot = fig5, width = 23, height = 13, units = "in")
ggsave(paste0(fig_path,"Figure5.png"), plot = fig5, width = 22, height = 12, units = "in")
ggsave(paste0(fig_path,"Figure5.pdf"), plot = fig5, width = 22, height = 12, units = "in")
```{r sup fig 11}
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F)
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F)  %>%
knitr::kable()
param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F)  %>%
knitr::kable()
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F)
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population)
unique(data$other_params)
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F) %>%
filter(other_params !=  "0.1_0")
unique(data$other_params)
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F) %>%
filter(other_params !=  "0.1_0") %>%
filter(other_params !=  "0.01_0")
unique(data$other_params)
data$other_params = factor(data$other_params, levels = c("0.001_1e-05", "0_0", "0.01_1e-05", "0.1_1e-07"),
ordered = TRUE, labels=c(expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7")))))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population)
unique(data$other_params)
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F) %>%
filter(other_params !=  "0.1_0") %>%
filter(other_params !=  "0.01_0")
unique(data$other_params)
data$other_params = factor(data$other_params, levels = c("0.001_1e-05", "0_0", "0.01_1e-05","0.1_1e-05", "0.1_1e-07"),
ordered = TRUE, labels=c(expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-05"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7")))))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population)
?scale_color_discrete
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = eval(parse(text= nam)))
data$other_params = factor(data$other_params, levels = c("0.001_1e-05", "0_0", "0.01_1e-05","0.1_1e-05", "0.1_1e-07"),
ordered = TRUE, labels=c("0.001_1e-05" = expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-05"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7")))))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = ))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) #+
labels = c("0.001_1e-05" = expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-05"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7")))))
labels = c("0.001_1e-05" = expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-05"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7"))))
data = param_116 %>%
filter(Model == "WF") %>%
filter(Method=="NPE") %>%
filter(flow_type == "NSF") %>%
filter(n_presim == "100000" & presim_rep == "1") %>%
unite(other_params, c("s_snv", "m_snv"), remove = F) %>%
filter(other_params !=  "0.1_0") %>%
filter(other_params !=  "0.01_0")
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = ))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) #+
labels = c("0.001_1e-05" = expression(atop("s = 0.001,", paste(delta, "  = 1e-5"))),
"0_0"  = expression(atop("s = 0,", paste(delta, "  = 0"))),
"0.01_1e-05"  = expression(atop("s = 0.01,", paste(delta, "  = 1e-5"))),
"0.1_1e-05"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-5"))),
"0.1_1e-07"  = expression(atop("s = 0.1,", paste(delta, "  = 1e-7"))))
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels)
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
#geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels)
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels) +
scale_fill_discrete(labels = labels)
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels) +
scale_fill_discrete(labels = labels, name = "Other beneficial mutations")
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(labels = labels)
data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none")
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none")
sup
sup
ggsave(paste0(fig_path,"SupplementaryFigure11.png"), plot = sup, width = 12, height = 12, units = "in")
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.spacing.x = unit(1.0, 'cm'))
sup
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.spacing.x = unit(5.0, 'cm'))
sup
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.spacing.y = unit(1.0, 'cm'))
sup
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.spacing.y = unit(3.0, 'cm'))
sup
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.position = 'top',
legend.spacing.x = unit(1.0, 'cm'))
sup
sup = data %>%
ggplot(aes(mu_est_10, s_est, color = other_params)) +
geom_point(aes(fill=other_params),size = 3, alpha = 0.5) +
geom_errorbar(aes(ymin = 10^fit_95hdi_low,ymax = 10^fit_95hdi_high)) +
geom_errorbarh(aes(xmin = mut_95hdi_low,xmax = mut_95hdi_high)) +
ylab("MAP s") +
xlab(expression(paste("log10(MAP ", delta,")"))) +
facet_wrap(~Population) +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
scale_fill_discrete(guide = "none") +
theme(legend.position = 'top')#,
sup
ggsave(paste0(fig_path,"SupplementaryFigure11.png"), plot = sup, width = 12, height = 12, units = "in")
ggsave(paste0(fig_path,"SupplementaryFigure11.png"), plot = sup, width = 13, height = 12, units = "in")
ggsave(paste0(fig_path,"SupplementaryFigure11.pdf"), plot = sup, width = 13, height = 12, units = "in")
a = data %>%
ggplot(aes(Population, mean_rmse_ppc, color=other_params)) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.5)) +
ylab("Posterior predictive check\nroot mean square error") +
xlab("")
b = data %>%
ggplot(aes(Population, mean_corr_ppc, color=other_params)) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.5)) +
ylab("Posterior predictive check\ncorrelation") +
xlab("")
sup = a / b + plot_annotation(tag_levels = 'A')
sup
sup = a + b + plot_annotation(tag_levels = 'A')
sup
a = data %>%
ggplot(aes(Population, mean_rmse_ppc, color=other_params)) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.5)) +
ylab("Posterior predictive check\nroot mean square error") +
xlab("") +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
theme(legend.position = 'bottom')
b = data %>%
ggplot(aes(Population, mean_corr_ppc, color=other_params)) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.5)) +
ylab("Posterior predictive check\ncorrelation") +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
xlab("")
sup = a / b + plot_annotation(tag_levels = 'A')
sup
b = data %>%
ggplot(aes(Population, mean_corr_ppc, color=other_params)) +
geom_pointrange(aes(ymin = rmse95_low_ppc,ymax = rmse95_hi_ppc), alpha=0.5,
position=position_dodge2(width=0.5)) +
ylab("Posterior predictive check\ncorrelation") +
scale_color_discrete(labels = labels,  name = "Other beneficial mutations") +
xlab("") +
theme(legend.position = "none")
sup = a / b + plot_annotation(tag_levels = 'A')
sup
ggsave(paste0(fig_path,"SupplementaryFigure12.png"), plot = sup, width = 12, height = 12, units = "in")
ggsave(paste0(fig_path,"SupplementaryFigure12.pdf"), plot = sup, width = 12, height = 12, units = "in")
library(tidyverse)
setwd("/Volumes/GoogleDrive/.shortcut-targets-by-id/19NQRq-XLPpjqJGmLbP4MHRjala2WVahk/Avecilla et al Simulating CNV evolution/scripts/cnv_sims_inference")
pops = read_csv('./hpc/new/PopPropForABC_all.csv')
gens = read_csv('./hpc/generations.csv')
data = cbind(pops, gens) %>%
pivot_longer(-Generation, names_to="Population", values_to="PropCNV")
p = ggplot(data,
aes(Generation, PropCNV, color=Population)) +
geom_line(size=1.5) +
scale_color_brewer(palette="Paired") +
theme_classic(base_size=16) +
scale_x_continuous(expand = c(0, 0), breaks = c(50, 100, 150, 200, 250)) +
scale_y_continuous("Proportion of cells with GAP1 CNV", expand = c(0, 0))
ggsave('../../figures/Fig1A.pdf', p, width = 7.2, height=5, units = "in")
#get supplementary data from Lauer et al into the right format
bc = read_csv("~/Downloads/SLGating03202018_GADATA.csv")
bc = bc %>% filter(Sample %in% c("gln_bc01", "gln_bc02")) %>%
filter(Generation != 174) %>%
select(Generation, Sample, PopProp_CNV) %>%
pivot_wider(names_from = Sample, values_from = PopProp_CNV) %>%
rename(bc01=gln_bc01, bc02 = gln_bc02)
write_csv(bc %>% select(bc01, bc02), './hpc/PopPropForABC_bc.csv')
write_csv(bc %>% select(Generation), './hpc/generations_bc.csv')
p = ggplot(data,
aes(Generation, PropCNV, color=Population)) +
geom_line(size=1.5) +
scale_color_brewer(palette="Paired") +
theme_classic(base_size=18) +
scale_x_continuous(expand = c(0, 0), breaks = c(50, 100, 150, 200, 250)) +
scale_y_continuous("Proportion of cells with GAP1 CNV", expand = c(0, 0))
ggsave('../../figures/Fig1A.pdf', p, width = 7.2, height=5, units = "in")
p = ggplot(data,
aes(Generation, PropCNV, color=Population)) +
geom_line(size=1.5) +
scale_color_brewer(palette="Paired") +
theme_classic(base_size=20) +
scale_x_continuous(expand = c(0, 0), breaks = c(50, 100, 150, 200, 250)) +
scale_y_continuous("Proportion of cells with GAP1 CNV", expand = c(0, 0))
ggsave('../../figures/Fig1A.pdf', p, width = 7.2, height=5, units = "in")
