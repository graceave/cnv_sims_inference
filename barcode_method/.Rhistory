mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(ss_between_species = n())#*(mean_bill_length_species - mean_bill_length)^2)
View(penguins)
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct()
penguins_bills_ss
library(tidyverse)
penguins <- penguins %>%
filter(!is.na(bill_length_mm)) %>%
mutate(mean_bill_length = mean(bill_length_mm)) %>%
group_by(species) %>%
mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(ss_between_species = n()*(mean_bill_length_species - mean_bill_length)^2)
str(penguins)
library(tidyverse)
penguins <- penguins %>%
filter(!is.na(bill_length_mm)) %>%
mutate(mean_bill_length = mean(bill_length_mm)) %>%
group_by(species) %>%
mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(n_species = n()) %>%
mutate(ss_between_species = n_species*(mean_bill_length_species - mean_bill_length)^2)
str(penguins)
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct()
penguins_bills_ss
View(penguins)
penguins <- read.csv('penguins.csv')
str(penguins)
library(tidyverse)
penguins <- penguins %>%
filter(!is.na(bill_length_mm)) %>%
mutate(mean_bill_length = mean(bill_length_mm)) %>%
group_by(species) %>%
mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(ss_between_species = n()*(mean_bill_length_species - mean_bill_length)^2)
str(penguins)
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct()
penguins_bills_ss
sum(penguins_bills_ss$ss_between_species)
# Chunk 1
knitr::include_graphics('palmer_penguins.png')
# Chunk 2
penguins <- read.csv('penguins.csv')
# Chunk 3
head(penguins)
# Chunk 4
str(penguins)
nrow(penguins)
# Chunk 5
unique(penguins$species)
# Chunk 6
mean_all <- mean(penguins$bill_length_mm)
# Chunk 7
mean_Adelie <- mean(penguins$bill_length_mm[penguins$species=='Adelie'])
mean_Adelie
# Chunk 8
mean_Adelie <- mean(penguins$bill_length_mm[penguins$species=='Adelie'], na.rm=T)
mean_Gentoo <- mean(penguins$bill_length_mm[penguins$species=='Gentoo'], na.rm=T)
mean_Chinstrap <- mean(penguins$bill_length_mm[penguins$species=='Chinstrap'], na.rm=T)
# Chunk 9
ss_Adelie <- (penguins$bill_length_mm[1] - mean_Adelie)^2
ss_Gentoo <- vector()
ss_Chinstrap <- vector()
for(i in 2:nrow(penguins)) {
if(penguins$species[i] == 'Adelie') {
ss_Adelie <- sum(ss_Adelie, (penguins$bill_length_mm[i] - mean_Adelie)^2, na.rm=T)
}
if(penguins$species[i] == 'Gentoo') {
ss_Gentoo <- sum(ss_Gentoo, (penguins$bill_length_mm[i] - mean_Gentoo)^2, na.rm=T)
}
if(penguins$species[i] == 'Chinstrap') {
ss_Chinstrap <- sum(ss_Chinstrap, (penguins$bill_length_mm[i] - mean_Chinstrap)^2, na.rm=T)
}
}
# Chunk 10
ss_within <- sum(ss_Adelie, ss_Gentoo, ss_Chinstrap)
n_Adelie = sum(penguins$species == 'Adelie' & !is.na(penguins$bill_length_mm))
n_Gentoo = sum(penguins$species == 'Gentoo' & !is.na(penguins$bill_length_mm))
n_Chinstrap = sum(penguins$species == 'Chinstrap' & !is.na(penguins$bill_length_mm))
ss_between <- sum(c(n_Adelie*(mean_Adelie - mean_all)^2, n_Gentoo*(mean_Gentoo - mean_all)^2, n_Chinstrap*(mean_Chinstrap - mean_all)^2))
# Chunk 1
knitr::include_graphics('palmer_penguins.png')
# Chunk 2
penguins <- read.csv('penguins.csv')
# Chunk 3
head(penguins)
# Chunk 4
str(penguins)
nrow(penguins)
# Chunk 5
unique(penguins$species)
# Chunk 6
mean_all <- mean(penguins$bill_length_mm)
mean_all
# Chunk 7
mean_all <- mean(penguins$bill_length_mm, na.rm =T)
mean_all
# Chunk 8
mean_Adelie <- mean(penguins$bill_length_mm[penguins$species=='Adelie'], na.rm=T)
mean_Gentoo <- mean(penguins$bill_length_mm[penguins$species=='Gentoo'], na.rm=T)
mean_Chinstrap <- mean(penguins$bill_length_mm[penguins$species=='Chinstrap'], na.rm=T)
# Chunk 9
ss_Adelie <- (penguins$bill_length_mm[1] - mean_Adelie)^2
ss_Gentoo <- vector()
ss_Chinstrap <- vector()
for(i in 2:nrow(penguins)) {
if(penguins$species[i] == 'Adelie') {
ss_Adelie <- sum(ss_Adelie, (penguins$bill_length_mm[i] - mean_Adelie)^2, na.rm=T)
}
if(penguins$species[i] == 'Gentoo') {
ss_Gentoo <- sum(ss_Gentoo, (penguins$bill_length_mm[i] - mean_Gentoo)^2, na.rm=T)
}
if(penguins$species[i] == 'Chinstrap') {
ss_Chinstrap <- sum(ss_Chinstrap, (penguins$bill_length_mm[i] - mean_Chinstrap)^2, na.rm=T)
}
}
# Chunk 10
ss_within <- sum(ss_Adelie, ss_Gentoo, ss_Chinstrap)
n_Adelie = sum(penguins$species == 'Adelie' & !is.na(penguins$bill_length_mm))
n_Gentoo = sum(penguins$species == 'Gentoo' & !is.na(penguins$bill_length_mm))
n_Chinstrap = sum(penguins$species == 'Chinstrap' & !is.na(penguins$bill_length_mm))
ss_between <- sum(c(n_Adelie*(mean_Adelie - mean_all)^2, n_Gentoo*(mean_Gentoo - mean_all)^2, n_Chinstrap*(mean_Chinstrap - mean_all)^2))
library(tidyverse)
penguins <- penguins %>%
filter(!is.na(bill_length_mm)) %>%
mutate(mean_bill_length = mean(bill_length_mm)) %>%
group_by(species) %>%
mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(ss_between_species = n()*(mean_bill_length_species - mean_bill_length)^2)
str(penguins)
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct()
penguins_bills_ss
sum(penguins_bills_ss$ss_between_species)
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct() %>%
ungroup() %>%
summarize(ss_within = sum(ss_species), ss_between = sum(ss_between_species))
penguins_bills_ss
# Chunk 1
knitr::include_graphics('palmer_penguins.png')
# Chunk 2
penguins <- read.csv('penguins.csv')
# Chunk 3
head(penguins)
# Chunk 4
str(penguins)
nrow(penguins)
# Chunk 5
unique(penguins$species)
# Chunk 6
mean_all <- mean(penguins$bill_length_mm)
mean_all
# Chunk 7
mean_all <- mean(penguins$bill_length_mm, na.rm =T)
mean_all
# Chunk 8
mean_Adelie <- mean(penguins$bill_length_mm[penguins$species=='Adelie'], na.rm=T)
mean_Gentoo <- mean(penguins$bill_length_mm[penguins$species=='Gentoo'], na.rm=T)
mean_Chinstrap <- mean(penguins$bill_length_mm[penguins$species=='Chinstrap'], na.rm=T)
# Chunk 9
ss_Adelie <- (penguins$bill_length_mm[1] - mean_Adelie)^2
ss_Gentoo <- vector()
ss_Chinstrap <- vector()
for(i in 2:nrow(penguins)) {
if(penguins$species[i] == 'Adelie') {
ss_Adelie <- sum(ss_Adelie, (penguins$bill_length_mm[i] - mean_Adelie)^2, na.rm=T)
}
if(penguins$species[i] == 'Gentoo') {
ss_Gentoo <- sum(ss_Gentoo, (penguins$bill_length_mm[i] - mean_Gentoo)^2, na.rm=T)
}
if(penguins$species[i] == 'Chinstrap') {
ss_Chinstrap <- sum(ss_Chinstrap, (penguins$bill_length_mm[i] - mean_Chinstrap)^2, na.rm=T)
}
}
# Chunk 10
ss_within <- sum(ss_Adelie, ss_Gentoo, ss_Chinstrap)
# Chunk 11
n_Adelie = sum(penguins$species == 'Adelie' & !is.na(penguins$bill_length_mm))
n_Gentoo = sum(penguins$species == 'Gentoo' & !is.na(penguins$bill_length_mm))
n_Chinstrap = sum(penguins$species == 'Chinstrap' & !is.na(penguins$bill_length_mm))
ss_between <- sum(c(n_Adelie*(mean_Adelie - mean_all)^2, n_Gentoo*(mean_Gentoo - mean_all)^2, n_Chinstrap*(mean_Chinstrap - mean_all)^2))
# Chunk 12
library(tidyverse)
penguins <- penguins %>%
filter(!is.na(bill_length_mm)) %>%
mutate(mean_bill_length = mean(bill_length_mm)) %>%
group_by(species) %>%
mutate(mean_bill_length_species = mean(bill_length_mm)) %>%
mutate(ss_species = sum((bill_length_mm - mean_bill_length_species)^2)) %>%
mutate(ss_between_species = n()*(mean_bill_length_species - mean_bill_length)^2)
str(penguins)
# Chunk 13
penguins_bills_ss <- penguins %>%
select(species, ss_species, ss_between_species) %>%
distinct()
penguins_bills_ss
penguins_bills_ss <- penguins_bills_ss %>%
ungroup() %>%
summarize(ss_within = sum(ss_species), ss_between = sum(ss_between_species))
penguins_bills_ss
# Chunk 14
ss_tot <- ss_within + ss_between
ss_tot
# Chunk 15
N <- nrow(penguins)
k <- length(unique(penguins$species))
mse <- ss_within/(N-k)
# Chunk 16
msg <- ss_between / (k-1)
# Chunk 17
f <- msg/mse
f
qf(0.99, k-1, N-k)
summary(aov(bill_length_mm~species, data = penguins))
rsq <- ss_between / ss_tot
rsq
pegnuins
penguins
plot(penguins$bill_length_mm, penguins$body_mass_g, xlab = 'Bill length (mm)', ylab = 'Body mass (g)')
library(ggplot2)
ggplot(penguins, aes(x=bill_length_mm, y=body_mass_g)) +
geom_point() +
theme_minimal(base_size = 12) +
facet_wrap(~species)
plot(penguins$bill_length_mm, penguins$body_mass_g, xlab = 'Bill length (mm)', ylab = 'Body mass (g)')
qt(c(0.025, 0.975), 2)
data(oil)
table(oilType)
downSample(fattyAcids, oilType)
bc02 = read_csv('bc02_cluster.csv') %>%
#select only lineages with >0 reads in first 3 time points
filter(time_point_1 > 0 & time_point_2 > 0 & time_point_3 > 0) %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8)
setwd("/Volumes/GoogleDrive/.shortcut-targets-by-id/19NQRq-XLPpjqJGmLbP4MHRjala2WVahk/Avecilla et al Simulating CNV evolution/scripts/cnv_sims_inference/barcode_method")
bc02 = read_csv('bc02_cluster.csv') %>%
#select only lineages with >0 reads in first 3 time points
filter(time_point_1 > 0 & time_point_2 > 0 & time_point_3 > 0) %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8)
library(tidyverse)
bc02 = read_csv('bc02_cluster.csv') %>%
#select only lineages with >0 reads in first 3 time points
filter(time_point_1 > 0 & time_point_2 > 0 & time_point_3 > 0) %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8)
bc02 = read_csv('bc02_cluster.csv')
head(bc02)
bc_02_freq = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads")
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads")
bc_02_downsampled %>% uncount(reads)
install.packages("groupdata2")
library(groupdata2)
df <- data.frame(
"participant" = factor(c(1, 1, 2, 3, 3, 3, 3, 4, 4, 5, 5, 5, 5)),
"diagnosis" = factor(c(0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0)),
"trial" = c(1, 2, 1, 1, 2, 3, 4, 1, 2, 1, 2, 3, 4),
"score" = sample(c(1:100), 13)
)
# Using downsample()
df
downsample(df, cat_col = "diagnosis")
downsample(df,
cat_col = "diagnosis",
id_col = "participant",
id_method = "n_ids"
)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint")
?count
bc_02_downsampled
head(bc_02_downsampled)
View(bc_02_downsampled)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n())
head(bc_02_downsampled)
?pivot_wider
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count)
View(bc_02_downsampled)
bc_02_downsampled_for_pyfit = bc_02_downsampled %>%
pivot_wider(names_from = timepoint, values_from = bc_count)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n())
bc_02_downsampled_for_pyfit = bc_02_downsampled %>%
pivot_wider(names_from = timepoint, values_from = bc_count)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) >%
pivot_wider(names_from = timepoint, values_from = bc_count)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count)
bc_02_downsampled %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8) %>%
ggplot(aes(generation, cell_number, group=Center)) +
geom_line(alpha=0.1) +
scale_y_log10(limits = c(1, 1e8), c(10^0, 10^1, 10^2, 10^3, 10^4, 10^5, 10^6, 10^7, 10^8))
View(bc_02_downsampled)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count) %>%
replace_na(0)
bc_02_downsampled = bc02 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count) %>%
replace(is.na(.), 0)
head(bc_02_downsampled)
bc_02_downsampled %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8) %>%
ggplot(aes(generation, cell_number, group=Center)) +
geom_line(alpha=0.1) +
scale_y_log10(limits = c(1, 1e8), c(10^0, 10^1, 10^2, 10^3, 10^4, 10^5, 10^6, 10^7, 10^8))
log10(0)
log10(1)
log10(2)
log10(10)
log10(100)
?write_csv
head(bc_02_downsampled)
#write for pyfitmut
write_csv(bc_02_downsampled %>% select(-Center), file = "bc_02_downsampled_PyFit.csv", col_names = F)
bc_04_downsampled = bc04 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count) %>%
replace(is.na(.), 0)
bc04 = read_csv('bc04_cluster.csv')
bc_04_downsampled = bc04 %>%
pivot_longer(cols=starts_with("time"), names_to = "timepoint", values_to = "reads") %>%
uncount(reads) %>%
downsample(cat_col = "timepoint") %>%
group_by(timepoint, Center) %>%
summarize(bc_count = n()) %>%
pivot_wider(names_from = timepoint, values_from = bc_count) %>%
replace(is.na(.), 0)
bc_04_downsampled %>%
%>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8) %>%
ggplot(aes(generation, cell_number, group=Center)) +
geom_line(alpha=0.1) +
scale_y_log10(limits = c(1, 1e8), c(10^0, 10^1, 10^2, 10^3, 10^4, 10^5, 10^6, 10^7, 10^8))
bc_04_downsampled %>%
#convert from reads to relative frequency
mutate(time_point_1 = time_point_1/sum(time_point_1),
time_point_2 = time_point_2/sum(time_point_2),
time_point_3 = time_point_3/sum(time_point_3),
time_point_4 = time_point_4/sum(time_point_4),
time_point_5 = time_point_5/sum(time_point_5),
time_point_6 = time_point_6/sum(time_point_6),
time_point_7 = time_point_7/sum(time_point_7)) %>%
pivot_longer(cols=starts_with("time"), names_to = "generation", values_to = "relative_freq") %>%
mutate(generation = case_when(generation == "time_point_1" ~ 0,
generation == "time_point_2" ~ 5,
generation == "time_point_3" ~ 37,
generation == "time_point_4" ~ 62,
generation == "time_point_5" ~ 99,
generation == "time_point_6" ~ 124,
generation == "time_point_7" ~ 149)) %>%
mutate(population = "bc02") %>%
mutate(cell_number = relative_freq*3e8) %>%
ggplot(aes(generation, cell_number, group=Center)) +
geom_line(alpha=0.1) +
scale_y_log10(limits = c(1, 1e8), c(10^0, 10^1, 10^2, 10^3, 10^4, 10^5, 10^6, 10^7, 10^8))
View(bc_02_downsampled)
